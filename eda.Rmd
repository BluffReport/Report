---
title: "eda for erosion"
author: "Yingmai Chen"
date: "2023-11-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(ggplot2)
library(tidyverse)
```


```{r}
erosion<-read.csv("erosion.csv")
```

```{r}
sel<-erosion%>%
  select(Bluff,RR..m.yr.,Wave.Height.for.NNE.wind.15.m.s..m.,Max.Wave.Height..m.)%>%
  slice(-c(3, 11, 14, 32))
```


```{r}
eda <- read.csv("report.csv")

ggplot(eda, aes(x = MaxWave, y = RR)) +
  geom_point() +
  geom_smooth(method = "loess", se = FALSE) +  # Adds a LOESS curve (local polynomial regression fitting)
  labs(title = "Scatter Plot of RR vs Max Wave Height with Non-linear Fitted Curve",
       x = "Max Wave Height(m)",
       y = "RR(m/yr)") +
  theme_minimal()
```

```{r}
ggplot(eda, aes(x = WaveHeight15, y = RR)) +
  geom_point() +
   geom_smooth(method = "loess", se = FALSE) + 
  labs(title = "Scatter Plot of RR vs Wave Height for NNE wind 15 m/s",
       x = "Wave Height for NNE wind 15 m/s (m)",
       y = "RR(m/yr)") +
  theme_minimal()
```
```{r}
# Load necessary libraries
library(readr)

# Read the data
data <- read_csv("erosion.csv")

# Sanitizing column names
names(data) <- gsub(" ", "_", names(data))
names(data) <- gsub("\\(", "", names(data))
names(data) <- gsub("\\)", "", names(data))
names(data) <- gsub("/", "_per_", names(data))
names(data) <- gsub("%", "percent", names(data))

# Update the name of the target variable if necessary
if ("RR (m/yr)" %in% names(data)) {
  names(data)[names(data) == "RR (m/yr)"] <- "RR_m_per_yr"
}

# Selecting predictors and the target variable
predictors <- setdiff(names(data), c("Bluff", "RR_m_per_yr"))
target <- "RR_m_per_yr"

# Creating the linear model
model_formula <- as.formula(paste(target, "~", paste(predictors, collapse = " + ")))
model <- lm(model_formula, data = data)

# Displaying the summary of the model
summary(model)

# Calculating predictions and evaluating the model
predictions <- predict(model, data)
mse <- mean((data[[target]] - predictions)^2)
rsquared <- summary(model)$r.squared

# Print MSE and R-squared
cat("Mean Squared Error (MSE):", mse, "\n")
cat("R-squared:", rsquared, "\n")


```

