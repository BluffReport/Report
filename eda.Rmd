---
title: "eda for erosion"
author: "Yingmai Chen"
date: "2023-11-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(ggplot2)
library(tidyverse)
```


```{r}
erosion<-read.csv("erosion.csv")
```

```{r}
sel<-erosion%>%
  select(Bluff,RR..m.yr.,Wave.Height.for.NNE.wind.15.m.s..m.,Max.Wave.Height..m.)%>%
  slice(-c(3, 11, 14, 32))
```


```{r}
eda <- read.csv("report.csv")

ggplot(eda, aes(x = MaxWave, y = RR)) +
  geom_point() +
  geom_smooth(method = "loess", se = FALSE) +  # Adds a LOESS curve (local polynomial regression fitting)
  labs(title = "Scatter Plot of RR vs Max Wave Height with Non-linear Fitted Curve",
       x = "Max Wave Height(m)",
       y = "RR(m/yr)") +
  theme_minimal()
```

```{r}
ggplot(eda, aes(x = WaveHeight15, y = RR)) +
  geom_point() +
   geom_smooth(method = "loess", se = FALSE) + 
  labs(title = "Scatter Plot of RR vs Wave Height for NNE wind 15 m/s",
       x = "Wave Height for NNE wind 15 m/s (m)",
       y = "RR(m/yr)") +
  theme_minimal()
```
```{r}
library(readr)
data <- read_csv("erosion.csv")
names(data) <- gsub(" ", "_", names(data))
names(data) <- gsub("\\(", "", names(data))
names(data) <- gsub("\\)", "", names(data))
names(data) <- gsub("/", "_per_", names(data))
names(data) <- gsub("%", "percent", names(data))
if ("RR (m/yr)" %in% names(data)) {
  names(data)[names(data) == "RR (m/yr)"] <- "RR_m_per_yr"
}
predictors <- setdiff(names(data), c("Bluff", "RR_m_per_yr"))
target <- "RR_m_per_yr"
model_formula <- as.formula(paste(target, "~", paste(predictors, collapse = " + ")))
model <- lm(model_formula, data = data)
summary(model)
predictions <- predict(model, data)
mse <- mean((data[[target]] - predictions)^2)
rsquared <- summary(model)$r.squared
cat("Mean Squared Error (MSE):", mse, "\n")
cat("R-squared:", rsquared, "\n")


```
```{r}
data <- read.csv("erosion.csv")  
model <- lm(`RR..m.yr.` ~ `Mud....`, data = data)
summary(model)
ggplot(data, aes(x = `Mud....`, y = `RR..m.yr.`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +  
  labs(title = "Linear Regression of RR (m/yr) on Mud (%)",
       x = "Mud (%)",
       y = "RR (m/yr)")

```
```{r}
model <- lm(`RR..m.yr.` ~ `Wave.Height.for.NNE.wind.15.m.s..m.`, data = data)
summary(model)
ggplot(data, aes(x = `Wave.Height.for.NNE.wind.15.m.s..m.`, y = `RR..m.yr.`)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +  
  labs(title = "Linear Regression of RR (m/yr) on Wave Height for NNE wind 15m/s",
       x = "Wave Height for NNE wind 15m/s",
       y = "RR (m/yr)")
```

